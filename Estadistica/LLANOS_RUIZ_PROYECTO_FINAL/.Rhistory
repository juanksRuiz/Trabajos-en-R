}
Mn <- s*(1.0/n)
return(n)
}
Mn <- MediaMuestral(10)
#Promedio de la exponencial
Ex <- 1/0.1
derr <- abs(Mn-Ex)/Ex
Errores <- vector('numeric',100)
for (i in 1:length(Errores)) {
Mn <- MediaMuestral(10)
Errores[i] <- abs(Mn-Ex)/Ex
}
qa <- quantile(Errores,seq(0.9,1,0.01))
qa
Errores
Mn
#a)
MediaMuestral <- function(n){
X <-  rexp(n,0.1)
s <- 0
for (i in 1:n) {
s <- s + X[i]
}
Mn <- s*(1.0/n)
return(Mn)
}
Mn <- MediaMuestral(10)
#Promedio de la exponencial
Ex <- 1/0.1
derr <- abs(Mn-Ex)/Ex
Errores <- vector('numeric',100)
for (i in 1:length(Errores)) {
Mn <- MediaMuestral(10)
Errores[i] <- abs(Mn-Ex)/Ex
}
qa <- quantile(Errores,seq(0.9,1,0.01))
qa
#Percentil 95
p95 <- qa[6]
hist(Errores)
?hist
hist(Errores)
?hist
hist(Errores,plot = FALSE)
hist(Errores,plot = TRUE)
source('~/Desktop/Trabajos-en-R/HOYOS_RUIZ_tarea4_punto1.R')
qb1
pb1
hist(Errores2)
Errores3 <- VectorErrores(100,10000,10)
qb2 <- quantile(Errores3,seq(0.95,0.96,0.01))
pb2 <- qb2[1]
hist(Errores2)
hist(Errores3)
?hist
hist(Errores3,breaks = seq(0,0.5,0.001)
hist(Errores3,breaks = seq(0,0.5,0.001))
hist(Errores3)
hist(Errores,plot = TRUE)
hist(Errores2,plot=TRUE)
hist(Errores3,plot=TRUE)
#b.1)
Errores2 <- VectorErrores(100,1000,10)
qb1 <- quantile(Errores2,seq(0.95,0.96,0.01))
pb1 <- qb1[1]
hist(Errores2,plot=TRUE)
hist(Errores3,plot=TRUE)
hist(Errores3,plot=TRUE,xlab = 'Errores')
2**2
?rnorm()
Comparar <- function(n,I){
dif <- vector('numeric',I)
for( i in 1:I){
Errores <- VectorErrores(1000,n,0)
qz <- quantile(ErroresZ,seq(0.6,0.7,0.1))
p60 = qz[1]
N <- rnorm(n,0,1)
qN <- quantile(N,seq(0.95,0.96,0.001))
p95 <- qN[1]
dif[i] = abs(p60-p95)/p95
}
return(dif)
}
ErroresZ <- VectorErrores(1000,10,0)
qz <- quantile(ErroresZ,seq(0.6,0.7,0.1))
ErroresZ
VectorErrores <- function(k,n,promTeo){
#Retorna lista con k elementos de los errores relativos
Err <- vector('numeric',k)
for(i in 1:k){
Mn <- MediaMuestral(n)
Err[i] = abs(Mn-promTeo)
}
return(Err)
}
Mn <- MediaMuestral(10)
#Promedio de la exponencial
Ex <- 1/0.1
derr <- abs(Mn-Ex)/Ex
Errores <- vector('numeric',100)
for (i in 1:length(Errores)) {
Mn <- MediaMuestral(10)
Errores[i] <- abs(Mn-Ex)/Ex
}
qa <- quantile(Errores,seq(0.9,1,0.01))
#Percentil 95
p95 <- qa[6]
hist(Errores,plot = TRUE,'Diferencia errores')
#Percentil 95
p95 <- qa[6]
hist(Errores,plot = TRUE,'Diferencia errores')
hist(Errores,plot = TRUE,'Diferencia errores')
source('~/Desktop/Trabajos-en-R/HOYOS_RUIZ_tarea4_punto1.R', encoding = 'UTF-8')
hist(Errores)
#b.1)
Errores2 <- VectorErrores(100,1000,10)
qb1 <- quantile(Errores2,seq(0.95,0.96,0.01))
pb1 <- qb1[1]
hist(Errores2,plot=TRUE,'Diferencia errores')
hist(Errores2)
hist(Errores3)
#c)
Zn <- function(n,promTeo,sd){
#promTeo y sd son de X
Mn = MediaMuestral(n)
Zn <- (Mn - promTeo)/(sd/(n**0.5))
return(Zn)
}
Comparar <- function(n,I){
dif <- vector('numeric',I)
for( i in 1:I){
Errores <- VectorErrores(1000,n,0)
qz <- quantile(ErroresZ,seq(0.6,0.7,0.1))
p60 = qz[1]
N <- rnorm(n,0,1)
qN <- quantile(N,seq(0.95,0.96,0.001))
p95 <- qN[1]
dif[i] = abs(p60-p95)/p95
}
return(dif)
}
ErroresZ <- VectorErrores(1000,10,0)
qz <- quantile(ErroresZ,seq(0.6,0.7,0.1))
p60 = qz[1]
# I= 1
dif1 <- Comparar(10,1)
#b)
dif2 <- Comparar(10,100)
hist(dif2)
dif3 <- Comparar(1000,100)
hist(dif3)
dif4 <- Comparar(10000,100)
hist(dif4)
#b)
dif2 <- Comparar(10,100)
hist(dif2)
dif
hist(dif2)
hist(dif3)
hist(dif4)
dif4 <- Comparar(1000000,100)
dif4 <- Comparar(10000,100)
?hist()
hist(dif2,title('Histograma de errores teoricos con n = 10'))
hist(dif2,title('Histograma con n = 10'))
hist(dif2)
rm(list = ls())
library(plyr)
install.packages("plyr")
install.packages("readxl")
install.packages("RcppRoll")
install.packages("reshape2")
install.packages("tidyverse")
install.packages("lubridate")
install.packages("forecast")
install.packages("polynom")
install.packages("urca")
install.packages("Rssa")
install.packages("lmtest")
install.packages("tseries")
install.packages("seasonal")
library(plyr)
library(readxl)
library(RcppRoll)
library(reshape2)
library(tidyverse)
library(lubridate)
library(forecast)
library(polynom)
library(urca)
library(Rssa)
library(lmtest)
library(tseries)
library(seasonal)
info <- read_excel("~/TO.xlsx")
info <- read_excel("Documents/TO.xlsx")
info <- read_excel("Documents/TO.xlsx")
info$mes <- ymd(info$mes)
info %>% ggplot(aes(x = mes, y = ocupación)) + geom_line(size = 1, color = "#A52A2A") +
labs(title = "Tasa de Ocupación",
subtitle = "Total Nacional",
x = "Tiempo",
y = "Porcentaje  (%)",
caption = "Fuente: Dane") +
theme_bw() +
scale_x_date(date_breaks = "12 months", date_labels = "%b %y")
info %>% mutate(o_ocup = ocupación - lag(ocupación)) %>% ggplot(aes(x = mes, y = o_ocup)) + geom_line(size = 1, color = "#A52A2A") +
labs(title = "Cambio mensual en la tasa de ocupación",
subtitle = "Total Nacional",
x = "Tiempo",
y = "Porcentaje  (%)",
caption = "Fuente: Dane") +
theme_bw() +
scale_x_date(date_breaks = "12 months", date_labels = "%b %y")
ggtsdisplay(diff(ts(info$ocupación, start = c(2011,1), frequency = 12)), main = "Cambio mensual en la tasa de ocupacion", plot.type = "histogram")
gglagplot(diff(ts(info$ocupación, start = c(2011,1), frequency = 12)), 12, do.lines = FALSE) + labs(subtitle = "Gráfico de dispersión", title = "Cambio mensual en la tasa de desempleo")
ggseasonplot(diff(ts(info$ocupación, start = c(2011,1), frequency = 12))) + labs(subtitle = "Gráfico de estaciones", title = "Cambio mensual en la tasa de desempleo")
timeseries <- ts(info$ocupación, frequency = 12)
plot(timeseries)
timeseries <- tsclean(timeseries)
diffts <- diff(timeseries)
difftscomponent <- decompose(diffts)
autoplot(info)
autoplot(timeseries)
xdxd <- decompose(timeseries, type = "multiplicative")
# Perform seasonal decomposition on the data with both decompose
# and stl:
d1 <- stats::decompose(nottem)
d2 <- stats::stl(nottem, s.window = "periodic", robust = TRUE)
View(d1)
class(nottem)
cbind(broom::tidy(nottem), broom::augment(d1),
broom::augment(d2))
# Visually compare seasonal decompositions in tidy data frames.
library(tibble)
library(dplyr)
library(tidyr)
library(ggplot2)
decomps <- tibble(
# Turn the ts objects into data frames.
series = list(as.data.frame(nottem), as.data.frame(nottem)),
# Add the models in, one for each row.
decomp = c("decompose", "stl"),
model = list(d1, d2)
) %>%
rowwise() %>%
# Pull out the fitted data using broom::augment.
mutate(augment = list(broom::augment(model))) %>%
ungroup() %>%
# Unnest the data frames into a tidy arrangement of
# the series next to its seasonal decomposition, grouped
# by the method (stl or decompose).
group_by(decomp) %>%
unnest(series, augment) %>%
mutate(index = 1:n()) %>%
ungroup() %>%
select(decomp, index, x, adjusted = .seasadj)
ggplot(decomps) +
geom_line(aes(x = index, y = x), colour = "black") +
geom_line(aes(x = index, y = adjusted, colour = decomp,
group = decomp))
timeseries <- ts(info$ocupación, frequency = 12)
plot(timeseries)
timeseries <- tsclean(timeseries)
diffts <- diff(timeseries)
difftscomponent <- stats::decompose(diffts)
adjusted_diffts <- diffts - difftscomponent$seasonal
acf(adjusted_diffts)
pacf(adjusted_diffts)
class(nottem)
rm(list = ls())
library(plyr)
library(readxl)
library(RcppRoll)
library(reshape2)
library(tidyverse)
library(lubridate)
library(forecast)
library(polynom)
library(urca)
library(Rssa)
library(lmtest)
library(tseries)
library(seasonal)
info <- read_excel("Documents/TO.xlsx")
info$mes <- ymd(info$mes)
info %>% ggplot(aes(x = mes, y = ocupación)) + geom_line(size = 1, color = "#A52A2A") +
labs(title = "Tasa de Ocupación",
subtitle = "Total Nacional",
x = "Tiempo",
y = "Porcentaje  (%)",
caption = "Fuente: Dane") +
theme_bw() +
scale_x_date(date_breaks = "12 months", date_labels = "%b %y")
info %>% mutate(o_ocup = ocupación - lag(ocupación)) %>% ggplot(aes(x = mes, y = o_ocup)) + geom_line(size = 1, color = "#A52A2A") +
labs(title = "Cambio mensual en la tasa de ocupación",
subtitle = "Total Nacional",
x = "Tiempo",
y = "Porcentaje  (%)",
caption = "Fuente: Dane") +
theme_bw() +
scale_x_date(date_breaks = "12 months", date_labels = "%b %y")
ggtsdisplay(diff(ts(info$ocupación, start = c(2011,1), frequency = 12)), main = "Cambio mensual en la tasa de ocupacion", plot.type = "histogram")
gglagplot(diff(ts(info$ocupación, start = c(2011,1), frequency = 12)), 12, do.lines = FALSE) + labs(subtitle = "Gráfico de dispersión", title = "Cambio mensual en la tasa de desempleo")
ggseasonplot(diff(ts(info$ocupación, start = c(2011,1), frequency = 12))) + labs(subtitle = "Gráfico de estaciones", title = "Cambio mensual en la tasa de desempleo")
timeseries <- ts(info$ocupación, frequency = 12)
plot(timeseries)
timeseries <- tsclean(timeseries)
diffts <- diff(timeseries)
difftscomponent <- stats::decompose(diffts)
adjusted_diffts <- diffts - difftscomponent$seasonal
acf(adjusted_diffts)
pacf(adjusted_diffts)
ggtsdisplay(timeseries)
ggtsdisplay(adjusted_diffts)
summary(m1 <- Arima(adjusted_diffts, order = c(1,1,1), include.mean = F)) # AR(1)
coeftest(m1)
f1 <- forecast(m1, h = 10)
plot(f1)
ts_ocup  <- ts(info$ocupación, frequency = 12, start = c(2011,1))
ggtsdisplay(ts_ocup)
summary(ur.df(adjusted_diffts, type = "trend", lags = 12, selectlags = "BIC"))
summary(ur.df(adjusted_diffts, type = "drift", lags = 12, selectlags = "BIC"))
summary(ur.df(adjusted_diffts, type = "none", lags = 12, selectlags = "BIC"))
View(difftscomponent)
qnorm
qnorm(20)
qnorm(5)
qnorm(0.55)
qnorm(0.23)
license()
clc
clear
close()
close.connection()
library(readr)
ks_projects_201801 <- read_csv("Downloads/kickstarter-projects/ks-projects-201801.csv")
View(ks_projects_201801)
mtcars
n = c(2,3,5)
n
s = c("aa","bb","cc")
s
b = c(TRUE, FALSE, FALSE)
B
b
df = data.frame(n,s,b)
df
df[0]
df
df[1]
df[:3]
df[s]
df.kernel()
df
df[1][4]
nrow(df)
ncol(df)
head(df)
df[[2]]
df[,2]
df[,1]
df[2,]
df[bb]
df
df[n]
source('~/Desktop/Trabajos-en-R/Estadistica/LLANOS_RUIZ_PROYECTO_FINAL/proyecto.R')
# 1: colesterol en funcion de presion arterial
# Para hombres/Mujeres, angina inducida/no inducida, azucar alto/bajo
plot(bd$age,bd$thalach,
col = "brown3",
pch = 20,
xlab = "Edad",
ylab = "Frecuencia cardiaca máxima (pul/min)")
modeloFE <- lm(bd$thalach,bd$age)
modeloFE <- lm(bd$thalach~bd$age)
abline(modeloFE)
abline(fit71)
abline(fit81)
abline(fit81)
# (6) presion arterial respecto al colesterol
# ENFERMOS:
cor(bdEnfermos$trestbps, bdEnfermos$chol)
fit91 <- lm(bdEnfermos$trestbps~bdEnfermos$chol)
summary(fit91)
abline(fit91)
summary(fit81)
fit72 <- lm(bdNoEnfermos$trestbps~bdNoEnfermos$oldpeak)
summary(fit72)
fit71 <- lm(bdEnfermos$trestbps~bdEnfermos$oldpeak)
summary(fit71)
abline(fit71)
plot(bdEnfermos$trestbps,bdEnfermos$oldpeak,
col = "brown3",
pch = 20,
main = "ENFERMOS: Depresion ST respecto a la presión arterial en reposo",
xlab = "Presion arterial en reposo (mm Hg)",
ylab = "Depresion ST")
abline(fit71)
plot(bdEnfermos$trestbps,bdEnfermos$chol,
col = "brown3",
pch = 20,
main = "ENFERMOS: Frecuencia cardiaca en funcion del colesterol",
xlab = "Colesterol mg/dl",
ylab = "Frecuencia cardiaca maxima (pul/min)")
plot(bdEnfermos$chol,bdEnfermos$thalalch,
col = "brown3",
pch = 20,
main = "ENFERMOS: Frecuencia cardiaca en funcion del colesterol",
xlab = "Colesterol mg/dl",
ylab = "Frecuencia cardiaca maxima (pul/min)")
fit61 <- lm(bdEnfermos$chol~bdEnfermos$thalach)
summary(fit61)
abline(fit61)
# SANOS
cor(bdNoEnfermos$chol, bdNoEnfermos$thalach)
plot(bdNoEnfermos$chol,bdEnfermos$thalalch,
col = "brown3",
pch = 20,
main = "NO ENFERMOS: Frecuencia cardiaca en funcion del colesterol",
xlab = "Colesterol mg/dl",
ylab = "Frecuencia cardiaca maxima (pul/min)")
fit62 <- lm(bdNoEnfermos$chol~bdNoEnfermos$thalach)
summary(fit62)
abline(fit62)
# (4) depresion ST respecto a la presion arterial
# ENFERMOS
cor(bdEnfermos$oldpeak, bdEnfermos$trestbps)
plot(bdEnfermos$trestbps,bdEnfermos$oldpeak,
col = "brown3",
pch = 20,
main = "ENFERMOS: Depresion ST respecto a la presión arterial en reposo",
xlab = "Presion arterial en reposo (mm Hg)",
ylab = "Depresion ST")
fit71 <- lm(bdEnfermos$trestbps~bdEnfermos$oldpeak)
summary(fit71)
abline(fit71)
# (3) frecuencia cardiaca en funcion del colesterol
cor(bd$chol, bd$thalach)
fit <- lm(bd$chol~bds$thalach)
fit <- lm(bd$chol~bd$thalach)
summary(fit61)
abline(fit61)
plot(bd$chol,bd$thalalch,
col = "brown3",
pch = 20,
main = "ENFERMOS: Frecuencia cardiaca en funcion del colesterol",
xlab = "Colesterol mg/dl",
ylab = "Frecuencia cardiaca maxima (pul/min)")
summary(fit61)
abline(fit61)
plot(bd$chol,bd$thalalch,
col = "brown3",
pch = 20,
xlab = "Colesterol mg/dl",
ylab = "Frecuencia cardiaca maxima (pul/min)")
abline(fit61)
summary(fit71)
abline(fit71)
# (6) presion arterial respecto al colesterol
# ENFERMOS:
cor(bdEnfermos$trestbps, bdEnfermos$chol)
plot(bdEnfermos$chol,bdEnfermos$trestbps,
col = "brown3",
pch = 20,
main = "ENFERMOS: Presion arterial respecto al colesterol",
xlab = "Colesterol",
ylab = "Presion arterial")
fit91 <- lm(bdEnfermos$trestbps~bdEnfermos$chol)
summary(fit91)
abline(fit91)
#SANOS
cor(bdNoEnfermos$trestbps, bdNoEnfermos$chol)
plot(bdEnfermos$chol,bdEnfermos$trestbps,
col = "brown3",
pch = 20,
main = "Presion arterial respecto al colesterol",
xlab = "Colesterol",
ylab = "Presion arteril")
# (6) presion arterial respecto al colesterol
# ENFERMOS:
cor(bdEnfermos$trestbps, bdEnfermos$chol)
fit92 <- lm(bdNoEnfermos$chol~bdNoEnfermos$trestbps)
abline(fit92)
abline(fit92)
fit92 <- lm(bdNoEnfermos$chol~bdNoEnfermos$trestbps)
summary(fit92)
abline(fit92)
abline(fit92)
abline(fit92)
# (6) presion arterial respecto al colesterol
# ENFERMOS:
cor(bdEnfermos$trestbps, bdEnfermos$chol)
plot(bdEnfermos$chol,bdEnfermos$trestbps,
col = "brown3",
pch = 20,
main = "ENFERMOS: Presion arterial respecto al colesterol",
xlab = "Colesterol",
ylab = "Presion arterial")
fit91 <- lm(bdEnfermos$trestbps~bdEnfermos$chol)
summary(fit91)
abline(fit91)
plot(bdEnfermos$chol,bdEnfermos$trestbps,
col = "brown3",
pch = 20,
main = "NO ENFERMOS: Presion arterial respecto al colesterol",
xlab = "Colesterol",
ylab = "Presion arteril")
fit92 <- lm(bdNoEnfermos$chol~bdNoEnfermos$trestbps)
summary(fit92)
abline(fit92)
